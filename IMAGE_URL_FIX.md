# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ —Å –ø–æ–ª–µ–º image_url

## üö® –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π —É—Å–ª—É–≥–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞:
```
ERROR: null value in column "image_url" of relation "gas" violates not-null constraint
```

## üîç –ü—Ä–∏—á–∏–Ω–∞

–í —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ `image_url` –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ NOT NULL, –Ω–æ –≤ Entity –º–æ–¥–µ–ª–∏ –æ–Ω–æ –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ nullable.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Entity –º–æ–¥–µ–ª–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `Gas.kt`:**
```kotlin
@Column(name = "image_url", length = 500, nullable = true, insertable = false, updatable = true)
val imageUrl: String? = null,
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `GasApiController.kt`:**
```kotlin
val gas = Gas(
    name = createGasDto.name,
    formula = createGasDto.formula,
    detailedDescription = createGasDto.detailedDescription
    // imageUrl –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏, —Ç–∞–∫ –∫–∞–∫ –ø–æ–ª–µ insertable = false
)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —É—Å–ª—É–≥–∏ –ø–æ–ª–µ `image_url` –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ INSERT
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ UPDATE
- –ü–æ–ª–µ –æ—Å—Ç–∞–µ—Ç—Å—è nullable –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç:

```sql
-- –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –∫–æ–ª–æ–Ω–∫—É
ALTER TABLE gas ADD COLUMN image_url_temp VARCHAR(500);

-- –ö–æ–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—Ç–∞—Ä–æ–π –∫–æ–ª–æ–Ω–∫–∏
UPDATE gas SET image_url_temp = image_url WHERE image_url IS NOT NULL;

-- –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –∫–æ–ª–æ–Ω–∫—É
ALTER TABLE gas DROP COLUMN image_url;

-- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –∫–æ–ª–æ–Ω–∫—É
ALTER TABLE gas RENAME COLUMN image_url_temp TO image_url;
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

```http
POST http://localhost:8080/api/gases
Content-Type: application/json

{
  "name": "H‚ÇÇ (–í–æ–¥–æ—Ä–æ–¥)",
  "formula": "H‚ÇÇ",
  "detailedDescription": "–í–æ–¥–æ—Ä–æ–¥ - —Å–∞–º—ã–π –ª–µ–≥–∫–∏–π —Ö–∏–º–∏—á–µ—Å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç"
}
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "success": true,
  "message": "–£—Å–ª—É–≥–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞",
  "data": {
    "id": 1,
    "name": "H‚ÇÇ (–í–æ–¥–æ—Ä–æ–¥)",
    "formula": "H‚ÇÇ",
    "detailedDescription": "–í–æ–¥–æ—Ä–æ–¥ - —Å–∞–º—ã–π –ª–µ–≥–∫–∏–π —Ö–∏–º–∏—á–µ—Å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç",
    "imageUrl": null
  }
}
```

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫ —É—Å–ª—É–≥–µ

```http
POST http://localhost:8080/api/gases/1/image
Content-Type: multipart/form-data

file: [–≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ .jpg/.png]
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "success": true,
  "message": "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ",
  "data": "http://localhost:9000/gas-images/gas-1-uuid.jpg"
}
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π —É—Å–ª—É–≥–∏

```http
GET http://localhost:8080/api/gases/1
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "name": "H‚ÇÇ (–í–æ–¥–æ—Ä–æ–¥)",
    "formula": "H‚ÇÇ",
    "detailedDescription": "–í–æ–¥–æ—Ä–æ–¥ - —Å–∞–º—ã–π –ª–µ–≥–∫–∏–π —Ö–∏–º–∏—á–µ—Å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç",
    "imageUrl": "http://localhost:9000/gas-images/gas-1-uuid.jpg"
  }
}
```

## üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã
SELECT column_name, is_nullable, data_type, character_maximum_length
FROM information_schema.columns
WHERE table_name = 'gas' AND column_name = 'image_url';

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
SELECT id, name, formula, image_url FROM gas ORDER BY id DESC LIMIT 5;
```

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü–æ–ª–µ `image_url` –æ—Å—Ç–∞–µ—Ç—Å—è NULL –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª–µ —á–µ—Ä–µ–∑ UPDATE
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ NOT NULL
- ‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å —É—Å–ª—É–≥—É —Å–Ω–æ–≤–∞ - –æ—à–∏–±–∫–∞ –¥–æ–ª–∂–Ω–∞ –∏—Å—á–µ–∑–Ω—É—Ç—å.
