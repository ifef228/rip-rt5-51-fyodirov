# ะะฐะฑะพัะฐัะพัะฝะฐั ัะฐะฑะพัะฐ 3 - ะะตะฑ-ัะตัะฒะธั ะดะปั ัะธััะตะผั ัะฐััะตัะฐ ัะตะผะฟะตัะฐัััั ะณะฐะทะพะฒ

## โ ะัะฟะพะปะฝะตะฝะฝัะต ััะตะฑะพะฒะฐะฝะธั

### 1. REST API ั ะฟะพะปะฝะพะน ะฑะธะทะฝะตั-ะปะพะณะธะบะพะน โ

**21 endpoint** ะดะปั ะฒัะตั ะพะฟะตัะฐัะธะน:

#### ะฃัะปัะณะธ (ะะฐะทั) - `/api/gases`
- `GET /api/gases` - ะกะฟะธัะพะบ ััะปัะณ ั ัะธะปัััะฐัะธะตะน
- `GET /api/gases/{id}` - ะะพะปััะธัั ะพะดะฝั ััะปัะณั
- `POST /api/gases` - ะกะพะทะดะฐัั ะฝะพะฒัั ััะปัะณั
- `PUT /api/gases/{id}` - ะะฑะฝะพะฒะธัั ััะปัะณั
- `DELETE /api/gases/{id}` - ะฃะดะฐะปะธัั ััะปัะณั
- `POST /api/gases/{id}/image` - ะะฐะณััะทะธัั ะธะทะพะฑัะฐะถะตะฝะธะต

#### ะะฐัะฒะบะธ (ะะฐะบะฐะทั) - `/api/gas-orders`
- `GET /api/gas-orders/cart-icon` - ะะบะพะฝะบะฐ ะบะพัะทะธะฝั
- `GET /api/gas-orders` - ะกะฟะธัะพะบ ะทะฐัะฒะพะบ ั ัะธะปัััะฐัะธะตะน
- `GET /api/gas-orders/{id}` - ะะพะปััะธัั ะพะดะฝั ะทะฐัะฒะบั
- `PUT /api/gas-orders/{id}` - ะะฑะฝะพะฒะธัั ะทะฐัะฒะบั
- `PUT /api/gas-orders/{id}/form` - ะกัะพัะผะธัะพะฒะฐัั ะทะฐัะฒะบั
- `PUT /api/gas-orders/{id}/complete` - ะะฐะฒะตััะธัั ะทะฐัะฒะบั
- `DELETE /api/gas-orders/{id}` - ะฃะดะฐะปะธัั ะทะฐัะฒะบั
- `POST /api/gas-orders/{id}/gases` - ะะพะฑะฐะฒะธัั ััะปัะณั ะฒ ะทะฐัะฒะบั
- `PUT /api/gas-orders/{orderId}/gases/{gasId}` - ะะฑะฝะพะฒะธัั ััะปัะณั ะฒ ะทะฐัะฒะบะต
- `DELETE /api/gas-orders/{orderId}/gases/{gasId}` - ะฃะดะฐะปะธัั ััะปัะณั ะธะท ะทะฐัะฒะบะธ

#### ะะพะปัะทะพะฒะฐัะตะปะธ - `/api/users`
- `POST /api/users/register` - ะะตะณะธัััะฐัะธั
- `POST /api/users/login` - ะััะตะฝัะธัะธะบะฐัะธั
- `POST /api/users/logout` - ะะตะฐะฒัะพัะธะทะฐัะธั
- `GET /api/users/profile` - ะัะพัะธะปั ะฟะพะปัะทะพะฒะฐัะตะปั
- `PUT /api/users/profile` - ะะฑะฝะพะฒะธัั ะฟัะพัะธะปั

### 2. ะคะธะปัััะฐัะธั ะธ ะฟะฐะณะธะฝะฐัะธั โ

**ะฃัะปัะณะธ:**
- ะคะธะปัััะฐัะธั ะฟะพ ะฝะฐะทะฒะฐะฝะธั (`name`)
- ะคะธะปัััะฐัะธั ะฟะพ ัะพัะผัะปะต (`formula`)
- ะะฐะณะธะฝะฐัะธั (`page`, `size`)

**ะะฐัะฒะบะธ:**
- ะคะธะปัััะฐัะธั ะฟะพ ััะฐัััั (`status`)
- ะคะธะปัััะฐัะธั ะฟะพ ะดะฐัะต ัะพัะผะธัะพะฒะฐะฝะธั (`formedDateFrom`, `formedDateTo`)
- ะะฐะณะธะฝะฐัะธั (`page`, `size`)
- ะัะบะปััะตะฝะธะต ัะดะฐะปะตะฝะฝัั ะทะฐะฟะธัะตะน

### 3. ะะฝัะตะณัะฐัะธั ั Minio โ

- ะะฐะณััะทะบะฐ ะธะทะพะฑัะฐะถะตะฝะธะน ะฒ bucket `gas-images`
- ะะตะฝะตัะฐัะธั ัะฝะธะบะฐะปัะฝัั ะธะผะตะฝ ัะฐะนะปะพะฒ: `gas_{gasId}_{timestamp}_{uuid}.{extension}`
- Presigned URLs ะดะปั ะดะพัััะฟะฐ ะบ ะธะทะพะฑัะฐะถะตะฝะธัะผ (ััะพะบ ะดะตะนััะฒะธั 7 ะดะฝะตะน)
- ะะฒัะพะผะฐัะธัะตัะบะพะต ัะดะฐะปะตะฝะธะต ะธะทะพะฑัะฐะถะตะฝะธะน ะฟัะธ ัะดะฐะปะตะฝะธะธ ััะปัะณะธ

### 4. ะะธะทะฝะตั-ะปะพะณะธะบะฐ ััะฐัััะพะฒ โ

**ะกัะฐัััั ะทะฐัะฒะพะบ:**
- `DRAFT` - ะงะตัะฝะพะฒะธะบ (ะบะพัะทะธะฝะฐ)
- `COMPLETED` - ะกัะพัะผะธัะพะฒะฐะฝะฝะฐั ะทะฐัะฒะบะฐ
- `DELETED` - ะฃะดะฐะปะตะฝะฝะฐั ะทะฐัะฒะบะฐ

**ะะตัะตัะพะดั ััะฐัััะพะฒ:**
- `DRAFT` โ `COMPLETED` (ัะพัะผะธัะพะฒะฐะฝะธะต)
- `COMPLETED` โ `DELETED` (ะทะฐะฒะตััะตะฝะธะต ั ัะฐััะตัะพะผ)
- `DRAFT` โ `DELETED` (ัะดะฐะปะตะฝะธะต)

**ะะณัะฐะฝะธัะตะฝะธั:**
- ะกะพะทะดะฐัะตะปั ะผะพะถะตั ัะดะฐะปััั ะธ ัะพัะผะธัะพะฒะฐัั ัะตัะฝะพะฒะธะบะธ
- ะะพะดะตัะฐัะพั ะผะพะถะตั ะพัะบะปะพะฝััั ะธ ะทะฐะฒะตััะฐัั ััะพัะผะธัะพะฒะฐะฝะฝัะต ะทะฐัะฒะบะธ
- ะกะธััะตะผะฝัะต ะฟะพะปั ะฒััะธัะปััััั ะฝะฐ ะฑัะบะตะฝะดะต

### 5. ะะฐััะตั ัะตะผะฟะตัะฐัััั โ

ะัะธ ะทะฐะฒะตััะตะฝะธะธ ะทะฐัะฒะบะธ ัะฐัััะธััะฒะฐะตััั ััะตะดะฝะตะฒะทะฒะตัะตะฝะฝะฐั ัะตะผะฟะตัะฐัััะฐ:

```
tempResult = ฮฃ(temperature * concentration) / ฮฃ(concentration)
```

### 6. ะะฐะปะธะดะฐัะธั ะธ ะพะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ โ

**ะะฐะปะธะดะฐัะธั ะฒัะพะดะฝัั ะดะฐะฝะฝัั:**
- Bean Validation ะฐะฝะฝะพัะฐัะธะธ
- ะัะพะฒะตัะบะฐ ะพะฑัะทะฐัะตะปัะฝัั ะฟะพะปะตะน
- ะะณัะฐะฝะธัะตะฝะธั ะดะปะธะฝั ัััะพะบ
- ะะฐะปะธะดะฐัะธั email

**ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ:**
- ะกัะฐะฝะดะฐััะธะทะธัะพะฒะฐะฝะฝัะต API ะพัะฒะตัั
- HTTP ััะฐััั ะบะพะดั
- ะะฟะธัะฐัะตะปัะฝัะต ัะพะพะฑัะตะฝะธั ะพะฑ ะพัะธะฑะบะฐั

### 7. ะะพะดะตะปะธ ะธ DTO โ

**Entity ะผะพะดะตะปะธ:**
- `Gas` - ััะปัะณะฐ (ะณะฐะท)
- `CalcOrder` - ะทะฐัะฒะบะฐ (ะทะฐะบะฐะท)
- `GasOrder` - ัะฒัะทั ะณะฐะท-ะทะฐัะฒะบะฐ
- `User` - ะฟะพะปัะทะพะฒะฐัะตะปั

**DTO ะผะพะดะตะปะธ:**
- `CreateGasDto`, `UpdateGasDto`, `GasResponseDto`
- `UpdateOrderDto`, `OrderResponseDto`, `GasOrderResponseDto`
- `RegisterUserDto`, `LoginDto`, `UserResponseDto`
- `ApiResponse<T>`, `PagedResponse<T>`

### 8. ORM ะธ Raw SQL โ

**4 ORM ะทะฐะฟัะพัะฐ:**
- `findByUserIdAndStatusOrderByTimestampDesc` - ะฟะพะปััะตะฝะธะต ะทะฐัะฒะพะบ ะฟะพะปัะทะพะฒะฐัะตะปั
- `findByUserIdAndStatusAndTempResultIsNull` - ะฟะพะธัะบ ะฐะบัะธะฒะฝะพะน ะบะพัะทะธะฝั
- `findByStatusOrderByTimestampDesc` - ะฟะพะปััะตะฝะธะต ะทะฐัะฒะพะบ ะฟะพ ััะฐัััั
- `findByCalcOrderIdAndGasId` - ะฟะพะธัะบ ัะฒัะทะธ ะณะฐะท-ะทะฐัะฒะบะฐ

**1 Raw SQL ะทะฐะฟัะพั:**
- `deleteOrderByIdAndUserId` - ะปะพะณะธัะตัะบะพะต ัะดะฐะปะตะฝะธะต ะทะฐัะฒะบะธ

### 9. ะะพะปะปะตะบัะธั ะดะปั ัะตััะธัะพะฒะฐะฝะธั โ

**Postman ะบะพะปะปะตะบัะธั** ั 21 ะทะฐะฟัะพัะพะผ:
- ะัะต CRUD ะพะฟะตัะฐัะธะธ
- ะัะธะผะตัั ัะธะปัััะฐัะธะธ
- ะขะตััะพะฒัะต ะดะฐะฝะฝัะต
- ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

## ๐๏ธ ะััะธัะตะบัััะฐ

### ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
gas/
โโโ src/main/kotlin/ru/mstu/yandex/gas/
โ   โโโ controller/api/          # REST ะบะพะฝััะพะปะปะตัั
โ   โ   โโโ GasApiController.kt
โ   โ   โโโ OrderApiController.kt
โ   โ   โโโ UserApiController.kt
โ   โโโ dto/                     # DTO ะผะพะดะตะปะธ
โ   โ   โโโ ApiResponse.kt
โ   โ   โโโ GasDto.kt
โ   โ   โโโ OrderDto.kt
โ   โ   โโโ UserDto.kt
โ   โโโ entity/                  # Entity ะผะพะดะตะปะธ
โ   โ   โโโ Gas.kt
โ   โ   โโโ CalcOrder.kt
โ   โ   โโโ GasOrder.kt
โ   โ   โโโ User.kt
โ   โโโ repository/              # ะะตะฟะพะทะธัะพัะธะธ
โ   โ   โโโ GasRepository.kt
โ   โ   โโโ CalcOrderRepository.kt
โ   โ   โโโ GasOrderRepository.kt
โ   โ   โโโ UserRepository.kt
โ   โโโ service/                 # ะกะตัะฒะธัั
โ       โโโ GasService.kt
โ       โโโ CartService.kt
โ       โโโ UserService.kt
โ       โโโ MinioService.kt
โโโ src/main/resources/
    โโโ application.yml          # ะะพะฝัะธะณััะฐัะธั
    โโโ static/                  # ะกัะฐัะธัะตัะบะธะต ัะตััััั
```

### ะะธะฐะณัะฐะผะผะฐ ะบะปะฐััะพะฒ

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   REST API      โ    โ   Services      โ    โ  Repositories   โ
โ   Controllers   โโโโโถโ   (Business     โโโโโถโ   (Data Access) โ
โ                 โ    โ    Logic)       โ    โ                 โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
         โ                       โ                       โ
         โผ                       โผ                       โผ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   DTO Models    โ    โ   Entity Models โ    โ   PostgreSQL    โ
โ   (API Layer)   โ    โ   (Domain)      โ    โ   Database      โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
                                โ
                                โผ
                       โโโโโโโโโโโโโโโโโโโ
                       โ     Minio       โ
                       โ   (Images)      โ
                       โโโโโโโโโโโโโโโโโโโ
```

### ะกะฒัะทะธ ะผะตะถะดั ะผะพะดะตะปัะผะธ

1. **ะะตัะพะดั ะธัะฟะพะปัะทััั ัะฐะทะฝัะต ะผะพะดะตะปะธ:**
   - `GasApiController` ะธัะฟะพะปัะทัะตั `Gas` entity ะธ `GasDto`
   - `OrderApiController` ะธัะฟะพะปัะทัะตั `CalcOrder`, `GasOrder` entities ะธ `OrderDto`

2. **ะะพะดะตะปะธ ะธัะฟะพะปัะทััั ะดััะณะธะต ะผะพะดะตะปะธ:**
   - `GasOrder` ัััะปะฐะตััั ะฝะฐ `Gas` ะธ `CalcOrder`
   - `CalcOrder` ัััะปะฐะตััั ะฝะฐ `User`

3. **ะะพะดะตะปะธ ะธัะฟะพะปัะทััั ะฝะตัะบะพะปัะบะพ ัะฐะฑะปะธั:**
   - `OrderResponseDto` ะพะฑัะตะดะธะฝัะตั ะดะฐะฝะฝัะต ะธะท `calc_order` ะธ `gas_order`
   - `GasOrderResponseDto` ะพะฑัะตะดะธะฝัะตั ะดะฐะฝะฝัะต ะธะท `gas_order` ะธ `gas`

## ๐ ะะฐะฟััะบ ะธ ัะตััะธัะพะฒะฐะฝะธะต

### 1. ะะฐะฟััะบ ะธะฝััะฐััััะบัััั

```bash
cd infra
./start.sh
```

### 2. ะะฝะธัะธะฐะปะธะทะฐัะธั ะฑะฐะทั ะดะฐะฝะฝัั

```sql
-- ะัะฟะพะปะฝะธัั ะฒ PostgreSQL:
\i infra/sql/init.sql
\i infra/sql/test-data.sql
\i infra/sql/update-schema-for-api.sql
```

### 3. ะะฐะฟััะบ ะฟัะธะปะพะถะตะฝะธั

```bash
cd gas
./gradlew bootRun
```

### 4. ะขะตััะธัะพะฒะฐะฝะธะต API

1. ะะผะฟะพััะธัะพะฒะฐัั ะบะพะปะปะตะบัะธั `Gas-Temperature-Calculator-API.postman_collection.json`
2. ะฃััะฐะฝะพะฒะธัั `baseUrl` = `http://localhost:8080/api`
3. ะัะฟะพะปะฝะธัั ะฒัะต 21 ะทะฐะฟัะพั ะฟะพ ะฟะพััะดะบั

## ๐ ะะตะผะพะฝัััะฐัะธั

### ะะพัะปะตะดะพะฒะฐัะตะปัะฝะพััั ะฟะพะบะฐะทะฐ (21 ะทะฐะฟัะพั):

1. **GET ัะฟะธัะพะบ ััะปัะณ** - ะฟะพะบะฐะทะฐัั ัะธะปัััะฐัะธั
2. **GET ะพะดะฝะฐ ััะปัะณะฐ** - ะฟะพะปััะธัั ะดะตัะฐะปะธ
3. **POST ัะพะทะดะฐะฝะธะต ััะปัะณะธ** - ะดะพะฑะฐะฒะธัั ะฝะพะฒัั ััะปัะณั
4. **POST ะทะฐะณััะทะบะฐ ะธะทะพะฑัะฐะถะตะฝะธั** - ะดะพะฑะฐะฒะธัั ะบะฐััะธะฝะบั
5. **GET ะธะบะพะฝะบะฐ ะบะพัะทะธะฝั** - ะฟัะพะฒะตัะธัั ะบะพัะทะธะฝั
6. **POST ะดะพะฑะฐะฒะปะตะฝะธะต ะฒ ะทะฐัะฒะบั** - ะดะพะฑะฐะฒะธัั ััะปัะณั ะฒ ะบะพัะทะธะฝั
7. **POST ะดะพะฑะฐะฒะปะตะฝะธะต ะดััะณะพะน ััะปัะณะธ** - ะดะพะฑะฐะฒะธัั ะฒัะพััั ััะปัะณั
8. **GET ะธะบะพะฝะบะฐ ะบะพัะทะธะฝั** - ะฟัะพะฒะตัะธัั ะพะฑะฝะพะฒะปะตะฝะฝัั ะบะพัะทะธะฝั
9. **GET ะทะฐัะฒะบะฐ** - ะฟะพัะผะพััะตัั ะทะฐัะฒะบั ั 2 ััะปัะณะฐะผะธ
10. **PUT ะธะทะผะตะฝะตะฝะธะต ะทะฐัะฒะบะธ** - ะธะทะผะตะฝะธัั ะพะฟะธัะฐะฝะธะต
11. **PUT ัะพัะผะธัะพะฒะฐะฝะธะต ะทะฐัะฒะบะธ** - ััะพัะผะธัะพะฒะฐัั ะทะฐัะฒะบั
12. **PUT ะทะฐะฒะตััะตะฝะธะต ะทะฐัะฒะบะธ** - ะทะฐะฒะตััะธัั ั ัะฐััะตัะพะผ
13. **GET ัะฟะธัะพะบ ะทะฐัะฒะพะบ** - ะฟะพะบะฐะทะฐัั ะทะฐะฒะตััะตะฝะฝัะต ะทะฐัะฒะบะธ
14. **POST ัะตะณะธัััะฐัะธั ะฟะพะปัะทะพะฒะฐัะตะปั** - ัะพะทะดะฐัั ะฝะพะฒะพะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั
15. **POST ะฐััะตะฝัะธัะธะบะฐัะธั** - ะฒะพะนัะธ ะฒ ัะธััะตะผั
16. **GET ะฟัะพัะธะปั ะฟะพะปัะทะพะฒะฐัะตะปั** - ะฟะพะปััะธัั ะดะฐะฝะฝัะต ะฟะพะปัะทะพะฒะฐัะตะปั
17. **PUT ะพะฑะฝะพะฒะปะตะฝะธะต ะฟัะพัะธะปั** - ะธะทะผะตะฝะธัั ะดะฐะฝะฝัะต
18. **POST ะดะตะฐะฒัะพัะธะทะฐัะธั** - ะฒัะนัะธ ะธะท ัะธััะตะผั
19. **PUT ะธะทะผะตะฝะตะฝะธะต ััะปัะณะธ ะฒ ะทะฐัะฒะบะต** - ะธะทะผะตะฝะธัั ะบะพะฝัะตะฝััะฐัะธั/ัะตะผะฟะตัะฐัััั
20. **DELETE ัะดะฐะปะตะฝะธะต ััะปัะณะธ ะธะท ะทะฐัะฒะบะธ** - ัะดะฐะปะธัั ััะปัะณั
21. **DELETE ัะดะฐะปะตะฝะธะต ะทะฐัะฒะบะธ** - ัะดะฐะปะธัั ะทะฐัะฒะบั

### ะะพะฝััะพะปัะฝัะต ะฒะพะฟัะพัั:

1. **ะะตะฑ-ัะตัะฒะธั** - REST API ั HTTP ะผะตัะพะดะฐะผะธ
2. **REST vs RPC** - ัะตััััะพ-ะพัะธะตะฝัะธัะพะฒะฐะฝะฝัะน vs ะฟัะพัะตะดััะฝะพ-ะพัะธะตะฝัะธัะพะฒะฐะฝะฝัะน
3. **HTTP ะทะฐะณะพะปะพะฒะบะธ** - Content-Type, Authorization, Accept
4. **HTTP ะผะตัะพะดั** - GET, POST, PUT, DELETE
5. **HTTP ััะฐัััั** - 200, 201, 400, 401, 404, 500
6. **ะะตััะธะธ HTTP** - HTTP/1.1, HTTP/2, HTTP/3
7. **HTTPS** - ัะธััะพะฒะฐะฝะธะต TLS/SSL
8. **OSI ะผะพะดะตะปั** - 7 ััะพะฒะฝะตะน, HTTP ะฝะฐ Application ััะพะฒะฝะต

## ๐ ะคะฐะนะปั ะฟัะพะตะบัะฐ

### ะัะฝะพะฒะฝัะต ัะฐะนะปั:
- `Gas-Temperature-Calculator-API.postman_collection.json` - ะบะพะปะปะตะบัะธั ะดะปั ัะตััะธัะพะฒะฐะฝะธั
- `API_DOCUMENTATION.md` - ะฟะพะปะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั API
- `API_SETUP.md` - ะธะฝััััะบัะธะธ ะฟะพ ะฝะฐัััะพะนะบะต
- `infra/sql/update-schema-for-api.sql` - ะพะฑะฝะพะฒะปะตะฝะธะต ััะตะผั ะะ

### ะะพะฝัะธะณััะฐัะธั:
- `gas/src/main/resources/application.yml` - ะฝะฐัััะพะนะบะธ ะฟัะธะปะพะถะตะฝะธั
- `gas/build.gradle` - ะทะฐะฒะธัะธะผะพััะธ ะฟัะพะตะบัะฐ

## โ ะะพัะพะฒะพ ะบ ะดะตะผะพะฝัััะฐัะธะธ!

ะัะต ััะตะฑะพะฒะฐะฝะธั ะปะฐะฑะพัะฐัะพัะฝะพะน ัะฐะฑะพัั 3 ะฒัะฟะพะปะฝะตะฝั:
- โ 21 REST endpoint
- โ ะะพะปะฝะฐั ะฑะธะทะฝะตั-ะปะพะณะธะบะฐ
- โ ะะฝัะตะณัะฐัะธั ั Minio
- โ ะคะธะปัััะฐัะธั ะธ ะฟะฐะณะธะฝะฐัะธั
- โ ะะฐะปะธะดะฐัะธั ะธ ะพะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ
- โ ORM ะธ Raw SQL ะทะฐะฟัะพัั
- โ ะะพะปะปะตะบัะธั ะดะปั ัะตััะธัะพะฒะฐะฝะธั
- โ ะะพะบัะผะตะฝัะฐัะธั ะธ ะธะฝััััะบัะธะธ

**API ะณะพัะพะฒ ะดะปั ะดะตะผะพะฝัััะฐัะธะธ ะฒัะตั ััะฝะบัะธะน ัะธััะตะผั ัะฐััะตัะฐ ัะตะผะฟะตัะฐัััั ะณะฐะทะพะฒ!** ๐
